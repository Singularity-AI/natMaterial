<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
 
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 80%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 80%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	 
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	 
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	width: 700px;
    font-size: 15px;
}
k{
    color: #990000;
	font-weight: bold;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px; 
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #C0F0E0;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;
	
}    
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}       
div.remark{
	background-color: #E3F2FD;	
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}  
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
} 

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}     

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed
	
}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>ITelAppl</title></head>
    
<body>
<div id="top">
<h1>DISI | ITel Healthcare<font size="5"></font> </h1>
</div>  

<div class="body"> 
<h2>Introduction</h2>
<ul>
<li><a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/overview" target="web">Confluence space: Nextagora</a> </li>
<li><a href="https://dev-itel.atlassian.net/wiki/spaces/UNIBO/overview" target="web">Confluence space: UNIBO</a> </li>
<li><a href="https://bitbucket.org/itelunibo/workspace/projects/" target="web">Projects on bitbucket</a> </li>
<li><a href="https://bitbucket.org/itelunibo/overviewrepo/src/master/it.unibo.itel/userDocs/3-LogicalArch/HDA_Disi.html" target="web">HDA_Disi.html (overviewrepo)</a> </li>
<hr/>
<!-- PROTECTED
<li><a href="http://htmlpreview.github.io/?https://bitbucket.org/itelunibo/overviewrepo/src/master/it.unibo.itel/userDocs/3-LogicalArch/HDA_Disi.html" target="web"> 
overviewrepo/src/master/it.unibo.itel/userDocs/3-LogicalArch/HDA_Disi.html</a></li>
 <li><a href="http://htmlpreview.github.io/?https://github.com/anatali/natMaterial/blob/master/health/userDocs/ITelAppl.html" target="web"> 
DISI - ITel applications</a>  </li>
-->
<li><a href="../../it.unibo.hapi2.2/userDocs/HapiUsage.html" target="web"> DISI - HapiUsage</a> (on <tt>.it.unibo.hapi2.2/userDocs/</tt>)</li>

 
<li><a href="../../../natMaterial/health/userDocs/HealthReferences.html" target="web"> 
DISI - HealthReferences.html</a> (on natMaterial/health/userDocs/)</li>
 
<li><a href="../../it.unibo.mirth.java/userDocs/MirthExperiments.html" target="web"> DISI - MirthExperiments</a> (on <tt>.health/userDocs/</tt>)</li>

</ul>
  

<h2>Overview</h2>
<a href="#Sm@rtEven">Sm@rtEven</a>  ha due tipi di UML-actors:
<ul>
<li><k>Operatore</k><br/>  
Un agente specializzato (ad es. un medico) che accede mediante
un browser ad una (unica?) piattaforma ITel installata presso un centro (ad es. ospedale). </li>
<li><k>Paziente</k><br>
Un agente non specializzato (una persona) che accede ai servizi erogati da una piattaforma ITel mediante computer e/o smartphone. </li>
</ul>

Terminologia:

<ul>
<li><m><ks>Area Geografica</ks></m>: una zona del mondo (con un proprio <m><ks>TimeZone</ks></m> ) </li>

<li><m><ks>EHR </ks></m> (Electronic Health Record): 
si veda <a href="https://www.aafp.org/practice-management/health-it/product/intro.html" target="web">
Introduction to Electronic Health Records</a>  
 </li>
 
<li><m><ks>EHR/M</ks></m> (Electronic Health Records Management): 
si veda  <a href="https://www.hilarispublisher.com/open-access/electronic-health-record-management-expectations-issues-and-challenges-2157-7420-1000265.pdf" target="web">
Electronic Health Record Management: Expectations, Issues, and Challenges (pdf)</a>
 </li>


<li><m><ks>Nestagora</ks></m>: denominazione della vecchia versione della piattaforma Itel</li>

<li><m><ks>Sm@rtSuite </ks></m>: denominazione della nuova versione della piattaforma Itel </li>

<li><m><ks>Sm@rtEven</ks></m>: prodotto ITel con <a href="#Sm@rtEven">funzionalita'</a> di gestione dei pazienti nel dominio Health 
supportato della piattaforma (vecchia e nuova) Itel.
 </li>

<li><m><ks>Core-Itel</ks></m>: nucleo sempre presente in ogni installazione <m><ks>Sm@rtEven </ks></m>: si veda
<a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/9568259/Modellazione+del+CORE" target="webcode">
ITel: Modellazione del CORE</a></li>

<li><m><ks>CentroBase</ks></m>: la struttura (cliente), entro una precisa <m><ks>Area Geografica</ks></m> , 
in cui viene installato (il <m><ks>Core Itel</ks></m> di) <m><ks>Sm@rtSuite </ks></m> unitamente a 
 <a href="#Sm@rtEven">Sm@rtEven</a> un set di <m><ks>ProdottoDiContesto</ks></m>.<br/>
In futuro un <m><ks>CentroBase</ks></m> potrebbe anche essere concepito come un centro-servizi in Cloud.
</li>

<li><m><ks>ProdottoDiContesto</ks></m> (ex adapter): un 'modulo' installabile nel <m><ks>CentroBase</ks></m> 
(o forse anche <k>remoto ???</k>) che fornisce servizi specializzati in un certo dominio applicativo 
(ad es. interazioni con <m><ks>CentroHealth</ks></m>)</li>

<li><m><ks>CentroHealth</ks></m>: una struttura specializzata che si occupa dei dati e dello stato di salute 
del <m><ks>Paziente</ks></m>.
<div class="remark">
<k>DISCUSSIONE 29/07/2020</k>: al momento si puo' ipotizzare che:
<ul>
<li>Un <m><ks>CentroBase</ks></m> sia sempre associato a un solo <m><ks>CentroHealth</ks></m></li>
<li>Un <m><ks>CentroHealth</ks></m> viene visto da Itel attraverso la mediazione di un <em>partner</em>, quale 
ad esempio <a href="https://www.dedalus.eu/" target="web">Dedalus</a></li>
<li>Il partner fornisce accessi agli <m><ks>EHR</ks></m> nascondendo a Itel i dettagli di uso di <m><ks>EHR/M</ks></m> </li>
<li>Itel concorda con il <em>partner</em> le modalità di interazione con il <m><ks>CentroHealth</ks></m>. 
	<ul>
	<li>Di solito accede a un server via <tt>HTTPS/TCP</tt>; il server (denominato qui <m><ks>CHFacade</ks></m>) può fungere da Facade  
	verso altri servizi interni, che risultano nascosti a Itel. </li>
	<li>I dati da scambiare con la <m><ks>CHFacade</ks></m> sono definiti da Itel, per cui il <em>partner</em> provvede a dotare la Facade
	di opportuni adapter.</li>
	<li><m><ks>Sm@rtEven </ks></m> potrebbe operare 'in modo autonomo', senza la
necessita' di interagire con <m><ks>CHFacade</ks></m> gestito da un <em>partner</em>.  
In questo caso si puo' pensare alla esistenza di un <m><ks>CentroHealth</ks></m> 'interno'.</li>
	</ul>
</li>
</ul>
</div>
<hr/>
</li>
 
<li><m><ks>Paziente</ks></m>: una persona modellata usando (un <k>sottoinsieme???</k> di) 
<a href="https://www.hl7.org/fhir/patient.html" target="webcode">FHIR Patient</a>, 
che vive in una determinata <m><ks>Area Geografica</ks></m>
ed e' noto al <m><ks>CentroHealth</ks></m> associato al <m><ks>CentroBase</ks></m>.
  </li>
  
<li><m><ks>Operatore</ks></m>: un agente (<i>Medico, Infermiere, Admin</i>) 
associato a un (o <k>sotto???</k>) insieme  di <m><ks>Paziente<ks></m> 
che utilizza/gestisce il <m><ks>CentroBase</ks></m> </li>

<li><m><ks>Enrollment</ks></m>: iscrizione nel <m><ks>CentroBase</ks></m> di un paziente.
<div class="remark">
<k>DISCUSSIONE 29/07/2020</k>:  Un <m><ks>Enrollment</ks></m> può essere iniziato dal <m><ks>CHFacade</ks></m>. Ad esempio,
uno schema in atto (con <a href="https://www.dedalus.eu/" target="web">Dedalus</a>) e' il seguente:
<ol>
<li><m><ks>CHFacade</ks></m> notifica (via <tt>POST</tt>) un nuovo paziente al <m><ks>CentroBase</ks></m> </li>
<li>Il <m><ks>CentroBase</ks></m>  ricava ulteriori dati del paziente consultando un centro anagrafico regionale </li>
<li>Il <m><ks>CentroBase</ks></m>  invia un <tt>ack</tt> al <m><ks>CHFacade</ks></m> </li>
<li><m><ks>CHFacade</ks></m> invia un piano terapeutico relativo a un paziente al <m><ks>CentroBase</ks></m></li>
<li>...</li>
</ol> 
Ovviamente e' anche possibile che un <m><ks>Enrollment</ks></m> sia iniziato da un <m><ks>Operatore</ks></m> del <m><ks>CentroBase</ks></m>.
</div>
 
</li>


<li><m><ks>HealthDevice</ks></m>: un dispositivo capace di effettuare misure (glicemia, pressione, etc) su un paziente</li>

<li><m><ks>ValoreMisurato</ks></m>: un dato ricavato dall'usp di un <m><ks>HealthDevice</ks></m> </li>

<li><m><ks>Piano terapeutico</ks></m>: un <i>Care Plan</i> (<k>sottoinsieme</k> ??? di)
<a href="https://www.hl7.org/fhir/careplan.html" target="webcode">FHIR careplan</a> relativo a un preciso
<m><ks>Paziente</ks></m>
</li>
</ul>

<h3 id="Sm@rtEven">User stories: Sm@rtEven</h3>
Si veda:
<ul>
<li><a href="https://miro.com/app/board/o9J_kt4wisk=/" target="confluence">ITel : Mappa funzioni SamrtSuite</a></li>
<li><a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/50200577/Documentazione+Requisiti" target="confluence">
ITel : Requisiti</a></li>
<li><a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/112263181/Sm+rtEven+-+Punti+Fissi" target="confluence">
ITel : Sm@rtEven Punti+Fissi</a></li>

</ul>



<table style="width:100%" border="1">
<tr>
<td style="width:50%">
 
<ks>Telemedicina</ks> ( Amministratore - Operatore )<br/>
<k>Amministratore</k>:
<ul>
<li>Gestione Utenti</li>
<li>Gestione Pazienti</li>
<li>Gestione Profili</li>
<li>Schemi terapeutici (azioni/misurzioni programmate)</li>
<li>Monitoraggio (allarmi, diario)</li>
<li>Gestione anagrafiche</li>
<li>Gestione questionari</li>
<li>Notifiche</li>
<li>Creazione report</li>
<li>Strumenti</li>
</ul>
<k>Operatore</k>: tutto tranne creare utenti<br/>
<br/> 
 
<ks>Teleconsulto</ks>
</td>
<td>
Altri moduli (out if DISI scope)
<ul>
<li>Sm@rtC6</li>
<li>Sm@rtWelcome</li>
<li>Sm@rtReady</li>
<li>Sm@rtContact</li>
<li>Sm@rtRecall</li>
<li>Sm@rtScreeing</li>
<li>Sm@rtSensor</li>
<li>Sm@rtConnect</li>
<li>Sm@rtTest</li>
<li>Sm@rtADI</li>
</ul>
</td>
</tr>
</table>
 

<h3>User stories: operatore</h3>
Come <k>Operatore</k> 
<ol>
<li>poter introdurre/eliminare <m><ks>Enrollment</ks></m> di un paziente </li>
<li>poter inviare/ricevere dati a/da  uno o più <m><ks>CentroHealth</ks></m> associati al paziente</li>
<li>ricevere notifiche su modifiche del <m><ks>Piano terapeutico</ks></m> del <m><ks>Paziente</ks></m> da parte di un <m><ks>CentroHealth</ks></m></li>
<li>inviare notifiche su modifiche del <m><ks>Piano terapeutico</ks></m> al <m><ks>Paziente</ks></m>  </li>
<li>monitorare un <m><ks>ValoreMisurato</ks></m> effettuato dal <m><ks>Paziente</ks></m> e/o il suo storico
e operare di conseguenza, anche inviando notifiche </li>



</ol> 
<h3>User stories: paziente</h3>
Come <k>paziente</k>:

<ol>
 
<li>ricevere supporto alla realizzazione di un <m><ks>Piano terapeutico</ks></m></li>
<li>ricevere notifiche su modifche del <m><ks>Piano terapeutico</ks></m></li>
<li>avere supporto per ottenere (via <a href="https://it.wikipedia.org/wiki/Bluetooth" target="web">Bluetooth</a>) 
un <m><ks>ValoreMisurato</ks></m> e inviarlo al <m><ks>CentroBase</ks></m> </li>

<li>effettuare un <ks>teleconsulto</ks></li>

</ol> 




<h2>Requirements: <m><ks>ProdottoDiContesto</ks></m> HEALTH</h2> 
La modularizzazione di Nestagora ha portato alla opportunità di incapsulare entro il <m><ks>ProdottoDiContesto</ks></m> 
denominato <a href="https://bitbucket.org/itelunibo/workspace/projects/HDA" target="confluence">
<k>Health Data Adapter</k></a> il problema della interazione con l'insieme di <tt>N>=1</tt> 
<m><ks>CentroHealth</ks></m> cui è associato un paziente.
<br/><br/>
L'assunzione è che le informazioni scambiate da ITel con un <m><ks>CentroHealth</ks></m> siano codificate in modo standard tramite:

<ul>
<li>scambio di dati <a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=185" target="web">HL7 Version 2</a></li>
<li>scambio di informazioni espresse in <a href="http://hl7.org/fhir/R4/index.html" target="webcode">FHIR</a></li>
</ul>

Le informazioni scambiate da ITel  con <k>Health Data Adapter</k></a> sono codificate usando  un sottoinsieme di
<a href="http://hl7.org/fhir/R4/index.html" target="webcode">FHIR</a>.<br/>

Qui sotto
(si veda <a href="https://dev-itel.atlassian.net/wiki/spaces/UNIBO/pages/142737409/FHIR+-+Itel+Scope" target="confluence">ITel-scope</a>)
sono evidenziati in giallo i concetti centrali e sottolineati in verde concetti secondari ma comunque di interesse ITel.<br/><br/>

<img src="./img/FHIR-ITel.png" alt="FHIR-ITel.png" width="80%"><br/>

<div class="remark">
 Per i dettagli sui <k>Domini di riferimento</k> si veda:
<a href="https://dev-itel.atlassian.net/wiki/spaces/UNIBO/pages/142737409/FHIR+-+Itel+Scope" target="confluence">FHIR - Itel Scope</a>
</div>

 


<h2>Requirement analysis</h2>

<ol>
<li>Le richieste provenienti da Itel verso <a href="https://bitbucket.org/itelunibo/workspace/projects/HDA" target="confluence">
<k>Health Data Adapter</k></a> dovrebbero contenere indicazioni sul <m><ks>CentroHealth</ks></m> implicato nella richiesta o
contenere informazioni da cui dedurre quale <m><ks>CentroHealth</ks></m> consultare.
<div class="remark">
<k>DISCUSSIONE 29/07/2020</k>:  Si esclude questo caso, in quanto un paziente che afferisce <m><ks>CentroBase</ks></m>
e' automaticamente associato al suo unico <m><ks>CentroHealth</ks></m>.
</div>
</li>
<li>...</li>
</ol>

<h2>Problem analysis</h2>
Come premessa e' opportuno consultare la discussione sui <i>Modelli di interazione</i> presentata in:

<a href="https://dev-itel.atlassian.net/wiki/spaces/UNIBO/pages/142704775/Health+-+Interazione" target="confluence">Health - Interazione</a>.
<br/><br/>

Prime osservazioni pssono essere:
<ul>
<li>Sostituire un oggetto con un <k>attore</k> non implica ancora l'insorgere di grosse problematiche relative ai sistemi distribuiti.
Tutto può avveire ancora su base locale con interazioni scambio di messaggi tra <k>oggetti attivi</k>, ciascuno dotato
di una <k>input queue</k>. In questo modo si evitano a priori problemi legati all'suo di di memoria comune.
</li>
<li>Attualmente il DISI utilizza attori basati su <k>Kotlin</k> che implicano meno librerie e sembrano anche più performanti rispetto ad attori
Akka. Si noti che Kotlin sta diventando il linguaggio di riferimento per applicazini su Android.
</li>
<li>
Si ricorda che si possono attivare migliaia di attori poichè gli attori sono gestiti con schemi 'a coroutine'.</li>

</ul>

<h3>Logical architecture</h3>
Si ricorda la legenda:
<img src="./img/components.png" alt="components.png" width="30%"  />

<h4>Oggetti + REST calls</h4>
<img src="./img/itelDisiHealthArch0.png" alt="itelDisiHealthArch0.png" width="80%"><br/>

<h3>Problemi FONDAMENTALI DA DISCUTERE</h3>
<ol>
<li>Cosa intendiamo esattamente per interazione REST?</li>
<li>Quando e perche' si introduce una interazione REST tra elementi (anche all'interno di <m><ks>Core-Itel</ks></m>?) 
al posto di una procedure call tra oggetti?</li>
<li>Interazione REST sono considerate necessarie nella interazione tra <m><ks>Core-Itel</ks></m> e 'mondo esterno' 
(adapter, ><m><ks>CentroHealth</ks></m>, etc)?</li>
<li>Quando, perche' e come viene introdotto il concetto di <k>Risorsa</k> implicato dalla interazione REST?</li>
<li>Una chiamata <em>REST sincrona</em> (call con attesa di risposta) pone grossi problemi, ben noti. In cosa consiste una chiamata <k>REST asincrona</k>?</li>
<li>In che modo e' <k>organizzato un server REST</k> quando deve gestire una chiamata asincrona?</li>
<li>In che modo un server REST <k>notifica informazioni</k> ai client(browser)?:<br/>
<ul>
<li>Usa <a href="hhttps://en.wikipedia.org/wiki/WebSocket" target="web">websockets</a> ( wikipedia) </li>
<li>Usa <a href="https://www.w3schools.com/html/html5_serversentevents.asp" target="web">
HTML Server-Sent Events(SSE) API</a>. Si veda anche 
<a href="https://en.wikipedia.org/wiki/Server-sent_events" target="web">Server-sent events</a> ( wikipedia)
</li>
<li>Usa un broker <a href="https://it.wikipedia.org/wiki/MQTT" target="web">MQTT</a> ( wikipedia)</li>
<li>Usa <a href="https://en.wikipedia.org/wiki/WebSub" target="web">WebSub</a> ( wikipedia) </li>

<li>...</li>
 
</ul>
</li>
</ol>
In prospettiva ci si può porre le seguente domanda:<br/><br/>

<li>Le <a href="https://cloud.google.com/healthcare" target="web">API Cloud Healthcare</a> che sembrano
usare le <a href="https://en.wikipedia.org/wiki/GRPC" target="web">gRPC</a>
(si veda anche <a href="https://cloud.google.com/endpoints/docs/grpc/about-grpc" target="web">
Google Cloud Endpoints for gRPC</a>) potrebbero rappresentare uno standard accettabile per la interoperabilita'
tra diversi <m><ks>CentriHealth</ks></m>? Oppure vanno trattate come 'soluzioni proprietarie' non-standard?.
</li>
<hr/>
Riportiamo qui di seguito alcuni appunti su concetti ben noti sui quali e' pero' opportuno concordare
al fine di impostare al meglio una architettura logica di progetto.

<h3>Dai dati ai Domini modellati da RISORSE</h3>
L'adozione di REST come paradigma di interazione implica che un servizio RESTful sia organizzato intorno
a un dominio espresso da un insieme di Risorse, ciascuna raggiungibile con un opportuno URI.
<br/><br/>
La definizione del paradigma e' data dalla tesi di Roy Fielding nel 2000, 
<a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="web">Architectural
Styles and the Design of Network-based Software Architectures</a>, discussa presso l’Universita' della
California, ad Irvine.
<br/><br/>
I  REST non sono necessariamente legati al Web, ma dal momento che il Web ha tutto quello che serve per essere considerata una
piattaforma di elaborazione distribuita secondo i principi REST, non sono necessarie altre
sovrastrutture per realizzare quello che è il Web programmabile. Il che è una dichiarazione di
aperto antagonismo ai Web Service basati su SOAP.

<h4>Principi REST</h4>
<ul>
<li>Identificazione delle risorse</li>
<li>Utilizzo esplicito dei metodi HTTP</li>
<li>Risorse autodescrittive</li>
<li>Collegamenti tra risorse</li>
<li>Comunicazione senza stato</li>
</ul>

<!-- 
JPA are nothing but POJOs representing data that can be persisted to the database
https://medium.com/@codespeaks/build-restful-services-with-spring-boot-2-x-in-few-steps-95c895a7abf5
per un esempio si veda https://github.com/letcodespeak/custsomer-service 
In customer-service folder, run mvnw spring-boot:run to start the application
<pre>
Find all customers
curl -s -G http://localhost:8088/restapi/customers | python -m json.tool
Find all customers with sorting
curl -s -G http://localhost:8088/restapi/customers?sort=customerId,desc | python -m json.tool
Find all accounts of one customer
curl -s -G http://localhost:8088/restapi/customers/1/accounts | json_pp
Add a new customer Iris
curl -s -H "Content-Type: application/json;accept: application/json" -X POST -d '{"customerName": "Iris Zhang","dateofBirth": "1985-03-16","phoneNumber": "+610452623738"}' http://localhost:8088/restapi/customers/ | json_pp
Add an account of customer Iris
curl -s -H "Content-Type: application/json;accept: application/json" -X POST -d '{"accountNumber": 30981069,"accountName": "gold plus","balance": 12000,"openingDate": "2016-05-16"}' http://localhost:8088/restapi/customers/3/accounts | json_pp
Update the new customer Iris
curl -s -H "Content-Type: application/json;accept: application/json" -X PUT -d '{"customerName": "Iris Wong","dateofBirth": "1985-03-16","phoneNumber": "+610452623738"}' http://localhost:8088/restapi/customers/3 | json_pp 
Update the account of customer Iris
curl -s -H "Content-Type: application/json;accept: application/json" -X PUT -d '{"accountNumber": 30981069,"accountName": "silver plus","balance": 12000,"openingDate": "2016-05-16"}' http://localhost:8088/restapi/customers/3/accounts/30981069 | json_pp
Delete the customer Iris and all linked accounts
curl -s -i -H "Content-Type: application/json;accept: application/json" -X DELETE  http://localhost:8088/restapi/customers/3/
</pre>
-->

<h4>Risorse</h4>
Per <k>Risorsa</k> si intende un qualsiasi elemento oggetto di elaborazione, ad esempio un <i>Paziente</i>, un <i>PianoTerapeutico</i>.
Per fare un parallelo con la programmazione ad oggetti possiamo dire che una risorsa puo' essere assimilata ad una istanza di una classe.
<br/>
Una risorsa deve essere identificata univocamente attraverso un URI. Ad esempio:
<pre>http://www.itel.com/pazienti/1234
http://www.itel.com/pianoterapuetico?codfiscpaziente=...	
</pre>

Nel progettare un Web Service in modalità REST e' utile evitare l’uso di verbi negli URI ma limitarsi ad utilizzare nomi, 
ricordandosi che un URI identifica una risorsa.<br/><br/>

REST stabilisce una mappatura uno a uno tra le tipiche operazioni
CRUD (creazione, lettura, aggiornamento, eliminazione di una risorsa) e i metodi HTTP.
<pre>
<b>Metodo HTTP          Operazione CRUD              Descrizione</b>
POST                 Create                       Crea una nuova risorsa
GET                  Read                         Ottiene una risorsa esistente
PUT                  Update                       Aggiorna una risorsa o ne modifica lo stato
DELETE               Delete                       Elimina una risorsa
</pre>

Il corpo di una richiesta HTTP con metodi PUT e POST e' pensato per il trasferimento della rappresentazione di una risorsa 
e non per eseguire chiamate remote o altre attività simili.

<h4>Rappresentazione delle Risorse</h4>
Le risorse sono concettualmente separate dalle rappresentazioni restituite al client. 
<br/><br/>
I principi REST non pongono nessun vincolo sulle modalita' di rappresentazione di una risorsa.<br/>
Di fatto, però, è opportuno utilizzare formati il più possibile standard in modo da
semplificare l’interazione con i client. Inoltre, sarebbe opportuno prevedere rappresentazioni
multiple di una risorsa, per soddisfare client di tipo diverso.
<br/><br/>
La possibilità di rappresentazioni multiple produce alcuni benefici pratici: ad esempio, se abbiamo
un output sia HTML, sia XML/Json, possiamo consumare il servizio sia con un’applicazione sia con un
comune browser. In altre parole, seguendo i principi REST nel progettare un’applicazione Web è
possibile costruire sia una Web API che una Web UI.

<br/><br/>
Il tipo di rappresentazione inviata dal Web Service al client è indicato nella stessa risposta HTTP
tramite un tipo <k>MIME</k>, così come avviene nella classica comunicazione tra Web server e browser.
Un client a sua volta ha la possibilità di richiedere una risorsa in uno specifico formato sfruttando
l’attributo Accept di una richiesta HTTP di tipo GET.


<h4>Collegamenti tra risorse</h4>
Un altro vincolo dei principi REST consiste nella necessita' che le risorse siano tra loro messe in
relazione tramite <em>link ipertestuali</em>. Questo principio e' anche noto come <k>HATEOAS</k> 
(<i>Hypermedia As The Engine Of Application State</i>), e pone l'accento sulle modalità di gestione
dello stato dell’applicazione.
<br/><br/>
In sostanza, tutto quello che un client deve sapere su una risorsa e sulle risorse ad essa correlate
deve essere contenuto nella sua rappresentazione o deve essere accessibile tramite collegamenti
ipertestuali.


<h4>Comunicazione stateless</h4>

La comunicazione stateless, non vuol dire che un’applicazione non deve avere stato. 
La responsabilità della gestione dello stato
dell’applicazione non deve essere conferita al server, ma rientra nei compiti del client.
<br/><br/>
Con una comunicazione senza stato è possibile creare cluster di server che
possono rispondere ai client senza vincoli sulla sessione corrente, ottimizzando le prestazioni
globali dell’applicazione. 


<!--Si veda <a href="https://www.html.it/pag/19596/i-principi-dellarchitettura-restful/" target="web">principi della architettura restful</a> -->


<br/><br/>

<h4>Attori + REST calls (cambio di paradigma)</h4>
L'adozione di interazioni REST significa avere sostituito oggetti con servizi e procedure-call con 
operazioni (asincrone) di message-passing. Siamo alle soglie di una cambio di paradigma nella costruzione del software
che costituisce il passo iniziale verso il mondo dei microservizi.


<img src="./img/itelDisiHealthArch1.png" alt="itelDisiHealthArch1.png" width="80%"><br/>
<br/>
<h2>Test plans</h2> 
 
<h2>PROGETTO</h2> 
<h4>Riferimenti al 24/07</h4>
<ul>
<li> <a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/50298891/Documentazione+Architetturale" target="confluence">
ITel : Architettura</a></li>

<li> <a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/50561114/Multitenancy+Access+Control" target="confluence">
ITel : Multitenancy & Access Control</a></li>

<li> <a href="https://dev-itel.atlassian.net/wiki/spaces/NEXTAGORA/pages/131497985/Architettura+Security" target="confluence">
ITel : Security</a></li>

 
</ul>

Per impostare un prima architettura di progetto, crediamo sia opportuno chiarire bene prima di tutto il senso della transizione da
Nestagora a Smartsuite e poi delienare un quadro di riferimento legato alle interazioni in  Sm@rteven. 
<h3>Sm@rteven su Nestagora</h3>
<table style="width:100%" border="1">
<tr>
<td style="width:30%">Versione iniziale errata
<img src="./img/nestagorasmarteven.png" alt="nestagorasmarteven.png" width="100%"><br/>
</td>
<td>Versione dopo DISCUSSIONE 29/07<br/>
<img src="./img/nestagorasmartevenreviewed.png" alt="nestagorasmartevenreviewed.png" width="100%"><br/>


</td>
</tr>
</table>

<h3>Sm@rtEven su Sm@rtSuite</h3>

<table style="width:100%" border="1">
<tr>
<td style="width:30%">Versione iniziale proposta
<img src="./img/Sm@rtEven.png" alt="Sm@rtEven.png" width="100%"><br/>
</td>
<td>Versione dopo DISCUSSIONE 29/07<br/>
<img src="./img/smartevenreviewed.png" alt="smartevenreviewed.png" width="100%"><br/>



</td>
</tr>
</table>



<h3>Interazioni nel mondo HL7</h3>
Lo standard di comunicazione HL7 prevede due possibili tipi di interazione, 
indipendemente dal modello del contenuto informativo scambiato nel messaggio (modellato sempre secondo HL7). In particolare:

<ul>
<li><h4>comunicazione UNSOLICITED</h4>
definisce un’interfaccia che consente di inviare un messaggio HL7 (dispatch) senza che questo sia stato richiesto su un canale TCP/IP ad hoc.
la comunicazione e' monodirezionale, dalla sorgente del messaggio al sistema interessato a ricevere aggiornamenti/informazioni
</li>
<li><h4>comunicazione SOLICITED</h4>
definisce un’interfaccia che prevede un’interazione in modalita' request-response
il sistema richiedente invia un messaggio HL7 <k>QRY</k> e il ricevente risponde con un messaggio codificato in HL7. 
Alcuni esempi: <tt>ADT, ORM, ORU, CD</tt>
</li>
</ul>


Indipendentemente dal meccanismo di comunicazione scelto, il protocollo HL7 può prevedere l’invio o meno 
di un <k>ACK</k> relativo ad ogni invio di messaggio/richiesta (protocollo <k>MLLP</k> su TCP/IP). 
<br/><br/>
L’invio dell’<k>ACK</k> non rende la comunicazione 'bidirezionale' (secondo quanto specifica HL7). 
Piu' precisamente:
<ul>
<li><h4>comunicazione BIDIREZIONALE</h4>
se e solo se tra due sistemi possono essere inviati messaggi unsolicited 
da entrambe le parti e/o se entrambe le parti possono richiedere messaggi solicited (via <k>QRY</k>)</li>
<li><h4>comunicazione MONODIREZIONALE</h4>
In tutti gli altri casi </li>
</ul>
  








<!--
http://htmlpreview.github.io/?https://github.com/anatali/natMaterial/blob/master/health/userDocs/ITelAppl.html
-->
<h2>Testing</h2> 
 
<h2>Deployment</h2> 

 


<h2>Maintenance</h2> 
 

<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
	      	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By AC - AN - AR | DISI Unibo  
<!-- <img src="./img/emiglio.png" alt="mbot" width="15%" height="15%"> -->
</div> 
</body>
</html>